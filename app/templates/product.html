{% extends 'base.html' %}
{% block title %}Products | BearCam{% endblock %}
{% block content %}
<div class="container my-5">
  <div class="d-flex justify-content-center mb-4 btn-toggle-group">
    <button class="btn btn-dark-bear me-2" id="btn-personal">Personal</button>
    <button class="btn btn-dark-bear" id="btn-empresa">Empresa</button>
  </div>
  
  <!-- Planes para uso Personal -->
  <div id="personal-plans" class="row">
    {% set personal_plans = [
      {'name': 'BearCam Mini', 'price': 39, 'desc': 'Ideal para interiores, visión HD y audio bidireccional.', 'features': ['Resolución 1080p', 'Visión nocturna', 'Grabación en la nube', 'Compatible con app móvil']},
      {'name': 'BearCam Outdoor', 'price': 89, 'desc': 'Resistente al agua, perfecta para exteriores con batería recargable.', 'features': ['Resolución 2K', 'Detección de movimiento', 'Batería de larga duración', 'IP65 resistente al clima']},
      {'name': 'BearCam Smart 360', 'price': 129, 'desc': 'Cámara inteligente con rotación automática y seguimiento de objetos.', 'features': ['Ángulo de visión 360°', 'Seguimiento automático', 'Almacenamiento local + nube', 'Control por voz (Alexa/Google)']}
    ] %}
    
    {% for plan in personal_plans %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="plan-card text-center">
        <div class="plan-title">{{ plan.name }}</div>
        <div class="price">{{ plan.price }} € / mes</div>
        <p class="plan-description">{{ plan.desc }}</p>
        <a href="{% if current_user.is_authenticated %}
                    {% if current_user.plan and current_user.plan.name == plan.name and current_user.plan.price == plan.price %}
                    {% else %}
                      {{ url_for('public.new_plan', plan=plan.name, price=plan.price) }}
                    {% endif %}
                 {% else %}
                    {{ url_for('public.new_plan', plan=plan.name, price=plan.price) }}
                 {% endif %}" 
           class="btn btn-primary w-100 my-3">
           {% if current_user.is_authenticated %}
              {% if current_user.plan and current_user.plan.name == plan.name and current_user.plan.price == plan.price %}
                Plan Activo
              {% else %}
                Actualizar mi plan
              {% endif %}
           {% else %}
              Contratar ahora
           {% endif %}
        </a>
        <ul class="list-unstyled plan-features text-start">
          {% for feat in plan.features %}
          <li>• {{ feat }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
    {% endfor %}
  </div>
  
  <!-- Planes para Empresa -->
  <div id="empresa-plans" class="row d-none">
    {% set empresa_plans = [
      {'name': 'BearCam Pro', 'price': 299, 'desc': 'Alta resolución, conexión PoE y grabación continua para negocios.', 'features': ['Resolución 4K Ultra HD', 'Visión nocturna IR avanzada', 'Conexión Power over Ethernet', 'Compatible con NVR profesional']},
      {'name': 'BearCam Corporate Kit', 'price': 999, 'desc': 'Pack completo de cámaras para empresas con acceso remoto y soporte técnico.', 'features': ['4 cámaras BearCam Pro', 'Acceso multiusuario', 'Almacenamiento en servidor seguro', 'Soporte técnico dedicado']},
      {'name': 'BearCam AI Surveillance', 'price': 49, 'desc': 'Servicio de vigilancia con IA para detección de amenazas en tiempo real.', 'features': ['Análisis en tiempo real', 'Alertas inteligentes por app o email', 'Reconocimiento facial', 'Informe mensual de seguridad']}
    ] %}

    {% for plan in empresa_plans %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="plan-card text-center">
        <div class="plan-title">{{ plan.name }}</div>
        <div class="price">{{ plan.price }} € / mes</div>
        <p class="plan-description">{{ plan.desc }}</p>
        <a href="{% if current_user.is_authenticated %}
                    {% if current_user.plan and current_user.plan.name == plan.name and current_user.plan.price == plan.price %}
                    {% else %}
                      {{ url_for('public.new_plan', plan=plan.name, price=plan.price) }}
                    {% endif %}
                 {% else %}
                    {{ url_for('public.new_plan', plan=plan.name, price=plan.price) }}
                 {% endif %}" 
           class="btn btn-primary w-100 my-3">
           {% if current_user.is_authenticated %}
              {% if current_user.plan and current_user.plan.name == plan.name and current_user.plan.price == plan.price %}
                Plan Activo
              {% else %}
                Actualizar mi plan
              {% endif %}
           {% else %}
              Contratar ahora
           {% endif %}
        </a>
        <ul class="list-unstyled plan-features text-start">
          {% for feat in plan.features %}
          <li>• {{ feat }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
